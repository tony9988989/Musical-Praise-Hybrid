# 初始种群生成与变异操作说明

## 一、功能概述

本模块实现了遗传算法中的两个核心功能：
1. **初始种群生成 (GetMelody)**：随机生成符合要求的旋律个体
2. **变异操作 (Mutations)**：包含移调、倒影、逆行等 8 种变异策略

---

## 二、代码位置

| 功能 | 文件 | 说明 |
|------|------|------|
| `Get_Melody()` | `demo.py` | 初始种群生成函数 |
| 变异策略 | `Mutations.py` | `mutation_strategies` 列表 |

---

## 三、初始种群生成

### 参数设置

| 参数 | 值 | 说明 |
|------|-----|------|
| 音域范围 | F3 ~ G5 | 索引 26 ~ 50 |
| 最小时值 | 6 | 八分音符 |
| 可用时值 | 6, 12, 18, 24, 36, 48 | 八分~全音符 |
| 总时值 | 240 | 四分音符 = 12 |

---

## 四、变异操作

### 题目要求的三种变换

| 函数名 | 音乐术语 | 说明 |
|--------|----------|------|
| `Transpose()` | 移调 | 所有音符整体上移/下移若干半音，保持音程关系 |
| `Inversion()` | 倒影 | 以第一个音为轴，音程关系上下翻转 |
| `Retrograde()` | 逆行 | 将旋律倒序播放（音高和时值都倒序） |

### 其他变异策略

| 函数名 | 说明 |
|--------|------|
| `Keep()` | 保持不变（空操作） |
| `ChangePitch()` | 随机改变一个音符的音高（±1~3半音） |
| `ChangeRhythm()` | 相邻音符间转移时值，保持总时值不变 |
| `SplitNote()` | 将一个音符分裂成两个 |
| `MergeNotes()` | 将相邻两个音符合并 |

---

## 五、音乐理论说明

### 移调 (Transposition)
将旋律整体上移或下移若干半音，保持音程关系不变。
```
原旋律：  C - E - G  (上行大三度 + 小三度)
上移2音： D - #F - A (上行大三度 + 小三度)
```

### 倒影 (Inversion)
以某个音为轴，将所有音程关系上下翻转。
```
原旋律：  C - E - G  (相对于C: +4, +7 半音)
倒影后：  C - bA - F (相对于C: -4, -7 半音)
```

### 逆行 (Retrograde)
将旋律按时间倒序播放。
```
原旋律： C - D - E - G
逆行后： G - E - D - C
```

---

## 六、使用方法

```bash
cd MusicalPhraseHybrid
python demo.py
```

程序将运行 50 代遗传算法，输出最优旋律。
